%Navrozidis Ioannis AEM: 9725
%Tzatsis Nikolaos AEM: 9701

clear all
%Country of choice: Belgium.
posRate = [0 0 37,06166868 21,52232509 29,95468111 25,2277104 20,88121531	12,17602716	5,38521827	2,229248898	2,079641192	1,720313993	1,764534034	1,311791214	1,114605677	0,772382991	0,751397622	0,646652746	0,74930598	0,902876637	1,594428136	2,498444119	2,586384841	3,071435648	2,948551665	2,520033279	2,147688878	2,295104614	2,879534636	4,02388535	4,392769892	7,287376005	12,54844711	17,25697439	22,5535412	23,91690183	20,80787221	17,02606516	11,13973599	7,928868865	7,283007903	7,19151026	6,543388643	6,101893441	4,96773408	4,830506554	4,617433146	4,943304553	4,797818711	4,414517351	4,317488298	5,883502076	5,880292437	5,399656703	6,3377714	7,112339663	7,120799613	7,277623488	8,572150158	8,719330632	7,929651243	6,328740483	5,725788836	5,055181951	4,851319671	3,96685907	2,920855982	1,895377461	1,106086397	0,833961009	0,903313844	1,759089291	1,898010519	2,462952604	2,940356418	3,477848218	3,797828269	4,513657779	4,924276775	4,876121217	4,600268126	4,378264117	4,105238465	4,287199894	4,771235145	6,497808307	8,514043915	9,2369836	11,05501895	12,9949733	14,90983197	15,00918864	15,31643833	14,18907251	7,492721624];

posRate20to352020 = [1.720313993 1.764534034 1.311791214	1.114605677	0.772382991	0.751397622	0.646652746	0.74930598	0.902876637	1.594428136	2.498444119	2.586384841	3.071435648	2.948551665	2.520033279	2.147688878];
posRate21to362020 = [1.764534034 1.311791214 1.114605677 0.772382991 0.751397622 0.646652746	0.74930598 0.902876637	1.594428136	2.498444119	2.586384841	3.071435648	2.948551665	2.520033279	2.147688878	2.295104614];
posRate22to372020 = [1.311791214 1.114605677 0.772382991 0.751397622 0.646652746	0.74930598 0.902876637	1.594428136	2.498444119	2.586384841	3.071435648	2.948551665	2.520033279	2.147688878	2.295104614	2.879534636];
posRate23to382020 = [1.114605677 0.772382991 0.751397622 0.646652746	0.74930598 0.902876637	1.594428136	2.498444119	2.586384841	3.071435648	2.948551665	2.520033279	2.147688878	2.295104614	2.879534636	4.02388535];
posRate24to392020 = [0.772382991 0.751397622 0.646652746	0.74930598 0.902876637	1.594428136	2.498444119	2.586384841	3.071435648	2.948551665	2.520033279	2.147688878	2.295104614	2.879534636	4.02388535	4.392769892];;

death25to402020 = [3 3 2 1 2 1 2 3 6 4 2 2 1 2 3 7];
%We will study the weekly deaths from weeks 25 through 40 of 2020.

b12020 = posRate24to392020/death25to402020;
b22020 = posRate23to382020/death25to402020;
b32020 = posRate22to372020/death25to402020;
b42020 = posRate21to362020/death25to402020;
b52020 = posRate20to352020/death25to402020;

%The highest coefficient is b1, so the best predictor is a 1 week delay.
figure(1);
scatter(posRate24to392020,death25to402020);
lsline

death25to402021 = [2 2 1 1 1 2 2 4 3 3 4 3 5 5 5 8];
%Similarly, we will study the weekly deaths from weeks 25 through 40 of 2021.

posRate20to352021 = [4.851319671 3.96685907	2.920855982	1.895377461	1.106086397	0.833961009	0.903313844	1.759089291	1.898010519	2.462952604	2.940356418	3.477848218	3.797828269	4.513657779	4.924276775	4.876121217];
posRate21to362021 = [3.96685907	2.920855982	1.895377461	1.106086397	0.833961009	0.903313844	1.759089291	1.898010519	2.462952604	2.940356418	3.477848218	3.797828269	4.513657779	4.924276775	4.876121217 4.600268126];
posRate22to372021 = [2.920855982 1.895377461 1.106086397 0.833961009	0.903313844	1.759089291	1.898010519	2.462952604	2.940356418	3.477848218	3.797828269	4.513657779	4.924276775	4.876121217 4.600268126 4.378264117];
posRate23to382021 = [1.895377461 1.106086397 0.833961009	0.903313844	1.759089291	1.898010519	2.462952604	2.940356418	3.477848218	3.797828269	4.513657779	4.924276775	4.876121217 4.600268126 4.378264117 4.105238465];
posRate24to392021 = [1.106086397 0.833961009	0.903313844	1.759089291	1.898010519	2.462952604	2.940356418	3.477848218	3.797828269	4.513657779	4.924276775	4.876121217 4.600268126 4.378264117 4.105238465 4.287199894];

b12021 = posRate24to392021/death25to402021;
b22021 = posRate23to382021/death25to402021;
b32021 = posRate22to372021/death25to402021;
b42021 = posRate21to362021/death25to402021;
b52021 = posRate20to352021/death25to402021;

%We notice again that the 1 week delay has the highest coefficient. So b12021.

figure(2);
scatter(posRate24to392021,death25to402021);
lsline

%Therefore, the number of deaths in a given week is predicted best by the
%positivity rate of the week before.
